package com.example.fptacademysystem.controller;import com.example.fptacademysystem.helper.ExcelHelper;import com.example.fptacademysystem.helper.ExcelSubjectHelper;import com.example.fptacademysystem.message.ResponseMessage;import com.example.fptacademysystem.services.ExcelSubjectService;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.http.HttpStatus;import org.springframework.http.ResponseEntity;import org.springframework.stereotype.Controller;import org.springframework.web.bind.annotation.PostMapping;import org.springframework.web.bind.annotation.RequestParam;import org.springframework.web.multipart.MultipartFile;@Controllerpublic class ExcelSubjectController {    @Autowired    ExcelSubjectService fileService;    @PostMapping("/api/admin/importsubject")    public ResponseEntity<ResponseMessage> uploadFile(@RequestParam("fileSubject") MultipartFile files) {        String message = "";        if (ExcelSubjectHelper.hasExcelFormat(files)) {            try {                fileService.save(files); // Save File                message = "Uploaded the file successfully: " + files.getOriginalFilename();                return ResponseEntity.status(HttpStatus.OK).body(new ResponseMessage(message));            } catch (Exception e) {                //message = "Could not upload the file: " + files.getOriginalFilename() + "!";                message = e.getMessage();                return ResponseEntity.status(HttpStatus.EXPECTATION_FAILED).body(new ResponseMessage(message));            }        }        message = "Please upload an excel file!";        return ResponseEntity.status(HttpStatus.BAD_REQUEST).body(new ResponseMessage(message));    }}