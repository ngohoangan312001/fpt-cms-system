//-------------------------//validate//-------------------------const Course = document.querySelector('#Courses');const StudentGroup = document.querySelector('#stugroid');const Semester = document.querySelector('#Semester');const Subject = document.querySelector('#subjdetailsid');const form = document.querySelector('#formCreate');const required = value => value === '' ? false : true;const resultValid = (result) => {    const regex = /^([0-9]+)$/;    return regex.test(result);};const showError = (input, message) => {    const formField = input.parentElement;    input.classList.remove('is-valid');    input.classList.add('is-invalid');    input.focus();    formField.classList.remove('success');    formField.classList.add('error');    // show message error with wrong input    const error = formField.querySelector('small');    error.classList.add('text-danger');    error.textContent = message;};const showSuccess = (input) => {    const formField = input.parentElement;    input.classList.remove('is-invalid');    input.classList.add('is-valid');    formField.classList.remove('error');    formField.classList.add('success');    // hide message error    const error = formField.querySelector('small');    error.textContent = ''; // assign null value to hide error message};// Validate courseconst checkCourse = (exam_course) => {    let valid = false;    const examcourse = exam_course.value;    if (!required(examcourse)) {        showError(exam_course, 'Please select a course !');    }else {        showSuccess(exam_course);        valid = true;    }    return valid;}// Validate Student Groupconst checkStudentGroup = (student_group) => {    let valid = false;    const studentgroup = student_group.value;    if (!required(studentgroup)) {        showError(student_group, 'Please select Student group !');    }else {        showSuccess(student_group);        valid = true;    }    return valid;}// Validate semesterconst checkSemester = (exam_semester) => {    let valid = false;    const semester = exam_semester.value;    if (!required(semester)) {        showError(exam_semester, 'Please select Semester !');    }else {        showSuccess(exam_semester);        valid = true;    }    return valid;}// Validate subjectconst checkSubject = (exam_subject) => {    let valid = false;    const subject = exam_subject.value;    if (!required(subject)) {        showError(exam_subject, 'Please select Subject !');    }else {        showSuccess(exam_subject);        valid = true;    }    return valid;}// Validate resultconst checkResult = (exam_result) => {    let valid = false;    const result = exam_result.value;    if (result<0) {        showError(exam_result, 'Result must be greater than or equal to 0 !');    }else if (result>100) {        showError(exam_result, 'Result must be less than or equal to 100 !');    }else if (!resultValid(result)) {        showError(exam_result, 'Results can only be numbers !');    }else if (!required(result)) {        showError(exam_result, 'Please enter result');    }else {        showSuccess(exam_result);        valid = true;    }    return valid;}//-------------------------// Validate create form//Trigger validation checkform.addEventListener('input', function (e) {    switch (e.target.id) {        case 'Courses':            checkCourse(Course);            break;        case 'stugroid':            checkStudentGroup(StudentGroup);            break;        case 'Semester':            checkSemester(Semester);            break;        case 'subjdetailsid':            checkSubject(Subject);            break;    }    if ($(e.target).hasClass('asmresult') || $(e.target).hasClass('objresult')) {        checkResult(e.target)    }});//----------------------//end validate//----------------------$(document).ready(function () {    //show all course    getAllCourses();    getAllCoursesForSearch();});$("#Courses").on("change", function () {    //remove and show new student group    getStudentGroupByCourse($(this).val());    //remove semester    $("#Semester").html('');    //remove subject    $("#subjdetailsid").html('');    //remove student list    $("#stuList tbody").html('');});$("#stugroid").on("change", function () {    //remove and show new Semester    getAllSemester();    //remove subject    $("#subjdetailsid").html('');    //remove student list    $("#stuList tbody").html('');});$("#Semester").on("change", function () {    //remove and show new subject    getSubjectDetail();    //remove student list    $("#stuList tbody").html('');});$("#subjdetailsid").on("change", function () {    var raw = $("#subjdetailsid option:selected").text();    var bout = raw.slice(raw.indexOf('BOUT:')+5,raw.indexOf('BOUT:') + 6);    $("#bout").val(bout);    //show new List    getStudentList($("#stugroid").val());});//get All coursefunction getAllCourses() {    $.ajax({        url: '/api/admin/result/findAllCourse',        type: "GET",        datatype: "JSON",        data: '',        success: function (result) {            var option = '<option value="" disabled selected>---select course---</option>';            for (var i in result) {                option += '<option class="courseOption" value="' + result[i].courid + '">' + result[i].cournm + '</option>';            }            $("#Courses").html(option);        }    });}//get All Semesterfunction getAllSemester() {    $.ajax({        url: '/api/admin/result/findAllSemester',        type: "GET",        datatype: "JSON",        data: '',        success: function (result) {            var option = '<option value="" disabled selected>---select Semester---</option>';            for (var i in result) {                option += '<option class="courseOption" value="' + result[i].semid + '">' + result[i].semnm + '</option>';            }            $("#Semester").html(option);        }    });}//get Student Group by Course idfunction getStudentGroupByCourse(courseId) {    $.ajax({        url: '/api/admin/result/findStudentgroup/' + courseId,        type: "GET",        datatype: "JSON",        data: '',        success: function (result) {            var option = '<option value="" disabled selected>--Select Student Group--</option>';            for (var i in result) {                option += '<option class="stuGroupOption" value="' + result[i].stugroid + '">' + result[i].stugronm + '</option>';            }            $("#stugroid").html(option);        }    });}//get subject detailsfunction getSubjectDetail() {    $.ajax({        url: '/api/admin/result/findSubjectDetails/'+$('#Semester').val()+'/'+$("#stugroid").val(),        type: "GET",        datatype: "JSON",        success: function (result) {            var option = '<option value="" disabled selected>---Select Subject---</option>';            for (var i in result) {                option += '<option class="subjectOption" value="' + result[i].subjdetailsid + '">' + result[i].subjnm + '</option>';            }            $("#subjdetailsid").html(option);        }    });}var ASMCheck = "";var OBJCheck = "";var ExamASMid=0;var ExamOBJid=0;var ResultASMid=0;var ResultOBJid=0;//get Student list by Student Group id// function getStudentList(StudentGroupId) {//     $.ajax({//         url: '/api/admin/result/findExamByStudentGroupAndSubjectDetail',//         type: "GET",//         datatype: "JSON",//         data: {//             stugroid: $('#stugroid').val(),//             subjdetailsid: $('#subjdetailsid').val(),//             bout:+$("#bout").val()//         },//         success: function (result) {//             ASMCheck = "";//             OBJCheck = "";//             ExamASMid = 0;//             ExamOBJid = 0;//             for (var i in result) {////                 if (result[i].examtype === "ASM") {//                     ASMCheck = result[i].examtype;//                     ExamASMid=result[i].examid;//                 }////                 if (result[i].examtype === "OBJ") {//                     OBJCheck = result[i].examtype;//                     ExamOBJid=result[i].examid;//                 }//             }//             $.ajax({//                 url: '/api/admin/result/findStudentByStudentGroup/' + StudentGroupId,//                 type: "GET",//                 datatype: "JSON",//                 data: {//                     examasmid:ExamASMid,//                     examobjid:ExamOBJid,//                     subjdetailsid: $('#subjdetailsid').val()//                 },//                 success: function (result) {//                     var option = '';//                     for (var i in result) {//                         option += '<tr>';//                         option += '<td class="stuid">' + result[i].stuid + '</td>';//                         option += '<td class="rollnum">' + result[i].rollnum + '</td>';//                         option += '<td class="fullname">' + result[i].fullnm + '</td>';//                         if(result[i].stustatus==="unavailable"){//                             option += '<td><input type="text" class="nonasmresult form-control" disabled placeholder="UNAVAILABLE"><br><small class="text-danger">STUDENT NOT PRESENT ENOUGH DAY TO TAKE EXAM</small></td>';//                             option += '<td><input type="text" hidden class="asmresultid form-control" value="0"></td>';//                             option += '<td><input type="text" class="nonobjresult form-control" disabled placeholder="UNAVAILABLE"><br><small class="text-danger">STUDENT NOT PRESENT ENOUGH DAY TO TAKE EXAM</small></td>';//                             option += '<td><input type="text" hidden class="objresultid form-control" value="0"></td>';//                         }else{//                             if (ASMCheck == "ASM") {//                                 if(result[i].asmResultId!=0){//                                     option += '<td><input type="text" class="asmresult form-control" value="'+result[i].asmResult+'" placeholder="Enter ASM result"><small></small></td>';//                                 }else{//                                     option += '<td><input type="text" class="asmresult form-control" placeholder="Enter ASM result"><small></small></td>';//                                 }//                                 option += '<td><input type="text" hidden class="asmresultid form-control" value="'+ result[i].asmResultId+'"></td>';//                             } else {//                                 option += '<td><input type="text" class="nonasmresult form-control" disabled placeholder="No ASM result"></td>';//                                 option += '<td><input type="text" hidden class="asmresultid form-control" value="0"></td>';//                             }//                             if (OBJCheck == "OBJ") {//                                 if(result[i].asmResultId!=0){//                                     option += '<td><input type="text" class="objresult form-control"value="'+result[i].objResult+'" placeholder="Enter OBJ result"><small></small></td>';//                                 }else{//                                     option += '<td><input type="text" class="objresult form-control" placeholder="Enter OBJ result"><small></small></td>';//                                 }//                                 option += '<td><input type="text" hidden class="objresultid form-control" value="'+ result[i].objResultId+'"></td>';//                             } else {//                                 option += '<td><input type="text" class="nonobjresult form-control" disabled placeholder="No OBJ result"></td>';//                                 option += '<td><input type="text" hidden class="objresultid form-control" value="0"></td>';//                             }//                         }//                         option += '</tr>';//                     }//                     $("#stuList tbody").html(option);////                 }//             });//         }//     });//// }//get Student list by Student Group idfunction getStudentList(StudentGroupId) {    $.ajax({        url: '/api/admin/result/findExamByStudentGroupAndSubjectDetail',        type: "GET",        datatype: "JSON",        data: {            stugroid: $('#stugroid').val(),            subjdetailsid: $('#subjdetailsid').val(),            bout:+$("#bout").val()        },        success: function (result) {            ASMCheck = "";            OBJCheck = "";            ExamASMid = 0;            ExamOBJid = 0;            for (var i in result) {                if (result[i].examtype === "ASM") {                    ASMCheck = result[i].examtype;                    ExamASMid=result[i].examid;                }                if (result[i].examtype === "OBJ") {                    OBJCheck = result[i].examtype;                    ExamOBJid=result[i].examid;                }            }            $.ajax({                url: '/api/admin/result/findStudentByStudentGroup/' + StudentGroupId,                type: "GET",                datatype: "JSON",                data: {                    examasmid:ExamASMid,                    examobjid:ExamOBJid,                    subjdetailsid: $('#subjdetailsid').val()                },                success: function (result) {                    var option = '';                    for (var i in result) {                        if(result[i].stustatus==="unavailable"){                            // not add student                        }else{                            option += '<tr>';                            option += '<td class="stuid">' + result[i].stuid + '</td>';                            option += '<td class="rollnum">' + result[i].rollnum + '</td>';                            option += '<td class="fullname">' + result[i].fullnm + '</td>';                            if (ASMCheck == "ASM") {                                if(result[i].asmResultId!=0){                                    option += '<td><input type="text" class="asmresult form-control" value="'+result[i].asmResult+'" placeholder="Enter ASM result"><small></small></td>';                                }else{                                    option += '<td><input type="text" class="asmresult form-control" placeholder="Enter ASM result"><small></small></td>';                                }                                option += '<td><input type="text" hidden class="asmresultid form-control" value="'+ result[i].asmResultId+'"></td>';                            } else {                                option += '<td><input type="text" class="nonasmresult form-control" disabled placeholder="No ASM result"></td>';                                option += '<td><input type="text" hidden class="asmresultid form-control" value="0"></td>';                            }                            if (OBJCheck == "OBJ") {                                if(result[i].objResultId!=0){                                    option += '<td><input type="text" class="objresult form-control"value="'+result[i].objResult+'" placeholder="Enter OBJ result"><small></small></td>';                                }else{                                    option += '<td><input type="text" class="objresult form-control" placeholder="Enter OBJ result"><small></small></td>';                                }                                option += '<td><input type="text" hidden class="objresultid form-control" value="'+ result[i].objResultId+'"></td>';                            } else {                                option += '<td><input type="text" class="nonobjresult form-control" disabled placeholder="No OBJ result"></td>';                                option += '<td><input type="text" hidden class="objresultid form-control" value="0"></td>';                            }                            option += '</tr>';                        }                    }                    $("#stuList tbody").html(option);                }            });        }    });}//submit formform.addEventListener('submit', function (e) {    e.preventDefault();    let isexamcoursevalid=checkCourse(Course),        isstudentgroupvalid=checkStudentGroup(StudentGroup),        issemestervalid=checkSemester(Semester),        issubjectvalid=checkSubject(Subject),        isresultvalid=true;    $("#stuList tbody tr").each(function(i, el) {        const asmresult = el.querySelector('.asmresult');        const objresult = el.querySelector('.objresult');        if(ASMCheck == "ASM"){            isresultvalid=isresultvalid && checkResult(asmresult);        }        if(OBJCheck == "OBJ"){            isresultvalid=isresultvalid && checkResult(objresult);        }    });    let isformvalid=isexamcoursevalid && isstudentgroupvalid && issemestervalid && issubjectvalid && isresultvalid;    if(isformvalid){        $("#stuList tbody tr").each(function(i, el) {            var data={                asmresult:$(el).find('.asmresult').val(),                objresult:$(el).find('.objresult').val(),                asmResultId:$(el).find('.asmresultid').val(),                objResultId:$(el).find('.objresultid').val(),                stuid:$(el).find('.stuid').text(),                examasmid:ExamASMid,                examobjid:ExamOBJid            };            $.ajax({                type: 'POST',                url: '/api/admin/result/saveResult',                data: JSON.stringify(data),                contentType: 'application/json',                success: function (result) {                    Swal.fire({                        position: 'center',                        icon: 'success',                        title: 'Success',                        showConfirmButton: false,                        timer: 1000                    });                    setTimeout("location.reload(true);", 1000);                },                error: function () {                    Swal.fire({                        position: 'center',                        icon: 'error',                        title: 'Error',                        showConfirmButton: false,                        timer: 1000                    });                }            });        });    }});$("#searchCourses").on("change", function () {    //remove and show new student group    getStudentGroupByCourseForSearch($(this).val());    //remove semester    $("#searchSemester").html('');    //remove subject    $("#searchsubjdetailsid").html('');    //remove student list    $("#searchstuList tbody").html('');});$("#searchstugroid").on("change", function () {    //remove and show new Semester    getAllSemesterForSearch();    //remove subject    $("#searchsubjdetailsid").html('');    //remove student list    $("#searchstuList tbody").html('');});$("#searchSemester").on("change", function () {    //remove and show new subject    getSubjectDetailForSearch();    //remove student list    $("#searchstuList tbody").html('');});$("#searchsubjdetailsid").on("change", function () {    var raw = $("#searchsubjdetailsid option:selected").text();    var bout = raw.slice(raw.indexOf('BOUT:')+5,raw.indexOf('BOUT:') + 6);    $("#searchbout").val(bout);//show new List    getStudentListForSearch($("#searchstugroid").val());});//get All coursefunction getAllCoursesForSearch() {    $.ajax({        url: '/api/admin/result/findAllCourse',        type: "GET",        datatype: "JSON",        data: '',        success: function (result) {            var option = '<option value="" disabled selected>---select course---</option>';            for (var i in result) {                option += '<option class="courseOption" value="' + result[i].courid + '">' + result[i].cournm + '</option>';            }            $("#searchCourses").html(option);        }    });}//get All Semesterfunction getAllSemesterForSearch() {    $.ajax({        url: '/api/admin/result/findAllSemester',        type: "GET",        datatype: "JSON",        data: '',        success: function (result) {            var option = '<option value="" disabled selected>---select Semester---</option>';            for (var i in result) {                option += '<option class="courseOption" value="' + result[i].semid + '">' + result[i].semnm + '</option>';            }            $("#searchSemester").html(option);        }    });}//get Student Group by Course idfunction getStudentGroupByCourseForSearch(courseId) {    $.ajax({        url: '/api/admin/result/findStudentgroup/' + courseId,        type: "GET",        datatype: "JSON",        data: '',        success: function (result) {            var option = '<option value="" disabled selected>--Select Student Group--</option>';            for (var i in result) {                option += '<option class="stuGroupOption" value="' + result[i].stugroid + '">' + result[i].stugronm + '</option>';            }            $("#searchstugroid").html(option);        }    });}//get subject detailsfunction getSubjectDetailForSearch() {    $.ajax({        url: '/api/admin/result/findSubjectDetails/'+$('#searchSemester').val()+'/'+$("#searchstugroid").val(),        type: "GET",        datatype: "JSON",        success: function (result) {            var option = '<option value="" disabled selected>---Select Subject---</option>';            for (var i in result) {                option += '<option class="subjectOption" value="' + result[i].subjdetailsid + '">' + result[i].subjnm + '</option>';            }            $("#searchsubjdetailsid").html(option);        }    });}var searchASMCheck = "";var searchOBJCheck = "";var searchExamASMid=0;var searchExamOBJid=0;var searchResultASMid=0;var searchResultOBJid=0;//get Student list by Student Group idfunction getStudentListForSearch(searchStudentGroupId) {    $.ajax({        url: '/api/admin/result/findExamByStudentGroupAndSubjectDetail',        type: "GET",        datatype: "JSON",        data: {            stugroid: $('#searchstugroid').val(),            subjdetailsid: $('#searchsubjdetailsid').val(),            bout:+$("#searchbout").val()        },        success: function (result) {            searchASMCheck = "";            searchOBJCheck = "";            searchExamASMid = 0;            searchExamOBJid = 0;            for (var i in result) {                if (result[i].examtype === "ASM") {                    searchASMCheck = result[i].examtype;                    searchExamASMid=result[i].examid;                }                if (result[i].examtype === "OBJ") {                    searchOBJCheck = result[i].examtype;                    searchExamOBJid=result[i].examid;                }            }            $.ajax({                url: '/api/admin/result/findStudentByStudentGroup/' + searchStudentGroupId,                type: "GET",                datatype: "JSON",                data: {                    examasmid:searchExamASMid,                    examobjid:searchExamOBJid,                    subjdetailsid: $('#searchsubjdetailsid').val()                },                success: function (result) {                    var option = '';                    var tablehead = '';                    var asmresultidcheck=0;                    var objresultidcheck=0;                    tablehead="<tr><th>Student id</th><th>Rollnum</th><th>Fullname</th>";                    for (var i in result) {                        option += '<tr>';                        option += '<td class="stuid">' + result[i].stuid + '</td>';                        option += '<td class="rollnum">' + result[i].rollnum + '</td>';                        option += '<td class="fullname">' + result[i].fullnm + '</td>';                        if(result[i].stustatus==="unavailable"){                            option += '<td colspan="4" class="text-secondary"><span class="text-danger">Attendance of students are not' +                                ' enough eligible to take the exam !</span></td>';                        }else{                            if (searchASMCheck == "ASM" && result[i].asmResultId!=0) {                                option += '<td>'+result[i].asmResult+'%</td>';                                asmresultidcheck=1;                                if(result[i].asmResult >= 40){                                    option += '<td class="text-success">PASS</td>';                                }else{                                    option += '<td class="text-danger">FAIL</td>';                                }                            } else {                                option += '<td class="text-secondary">No Result</td>';                            }                            if (searchOBJCheck == "OBJ" && result[i].objResultId!=0) {                                option += '<td>'+result[i].objResult+'%</td>';                                objresultidcheck=1;                                if(result[i].objResult >= 40 ){                                    option += '<td class="text-success">PASS</td>';                                }else{                                    option += '<td class="text-danger">FAIL</td>';                                }                            } else {                                option += '<td class="text-secondary">No Result</td>';                            }                        }                        option += '</tr>';                    }                    if(searchASMCheck == "ASM" && asmresultidcheck){                        tablehead+="<th>ASM RESULT<br><small>(RESULT FOR ASM)</small></th><th>ASM STATUS<br><small>( <40 IS FAIL & >= 40 IS PASS )</small></th>";                    } else {                        tablehead+="<th>ASM RESULT<br><small>(RESULT FOR ASM)</small></th>";                    }                    if (searchOBJCheck == "OBJ" && objresultidcheck) {                        tablehead+="<th>OBJ RESULT<br><small>(RESULT FOR OBJ)</small></th><th>OBJ STATUS<br><small>( <40 IS FAIL & >= 40 IS PASS )</small></th>";                    } else {                        tablehead+="<th>OBJ RESULT<br><small>(RESULT FOR OBJ)</small></th>";                    }                    tablehead+="</tr>";                    $("#tabledb1 tbody").html(option);                    $("#tabledb1 thead").html(tablehead);                }            });        }    });}